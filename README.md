# 自动按键程序

这是一个Python自动按键程序，用于循环按下指定的按键序列：反引号（`）→ 向上键 → 回车键。

## 功能特性

- 🔄 循环按键：反引号 → 向上键 → 回车键
- ⏱️ 可调节按键间隔时间
- 🛑 ESC键快速停止
- 🔒 安全机制：鼠标移动到屏幕左上角自动停止
- 📦 支持打包成可执行文件

## 安装依赖

首先安装所需的Python包：

```bash
pip install -r requirements.txt
```

## 使用方法

### 方法1：GUI界面版本（推荐）

#### 自动依赖检查版本（最佳选择）：
```bash
# 双击运行（自动检查和安装依赖）
start_with_dependencies.bat
```

#### 手动运行：
```bash
# 先安装依赖
pip install -r requirements.txt

# 然后运行程序
python auto_key_presser_gui.py
```

或者双击 `run_gui.bat` 文件（Windows）

#### GUI版本特性：
- 🖥️ 直观的图形界面
- 📊 实时显示当前按键状态
- 📈 按键计数统计
- 📝 详细的按键历史记录
- ⚙️ 可调节按键延迟设置
- 🔘 一键开始/停止控制
- 🎛️ 自定义按键序列配置
- 🔒 安全机制开关（ESC键停止、失效保护）
- 📋 预设按键序列模板



### 程序使用步骤

1. 运行程序后，会有3秒倒计时
2. 程序开始自动按键循环
3. 按下 **ESC键** 停止程序
4. 或者将鼠标移动到屏幕左上角也会停止程序

## 打包成可执行文件

如果您想要将程序打包成可执行文件，可以使用PyInstaller：

```bash
# 安装PyInstaller
pip install pyinstaller

# 打包程序
pyinstaller --onefile --windowed --name=自动按键程序_GUI版 auto_key_presser_gui.py
```

打包完成后，可执行文件将位于 `dist/` 目录中。

## 注意事项

⚠️ **重要提醒**：
- 请确保在运行程序前已经切换到目标应用程序窗口
- 程序会持续按键，请谨慎使用
- 建议在测试环境中先行测试
- 程序启动后有3秒缓冲时间，请准备好切换到目标窗口

## 安全机制

程序内置了多种安全机制：
- **ESC键停止**：随时按下ESC键即可停止程序
- **失效保护**：鼠标移动到屏幕左上角自动停止
- **异常处理**：程序出错时自动停止

## 自定义配置

### 通过GUI界面配置（推荐）：
- **设置按钮**：调整按键延迟时间（0.1-5.0秒）
- **自定义按键按钮**：修改按键序列或使用预设模板
- **安全设置**：启用/禁用ESC键停止和失效保护

### 预设按键序列：
1. **默认序列**：反引号(`) → 向上键(↑) → 回车键(↵)
2. **方向键序列**：上(↑) → 下(↓) → 左(←) → 右(→)
3. **数字键序列**：1 → 2 → 3 → 4 → 5

### 自定义按键格式：
```
显示名称,按键代码
例如：
反引号 `,`
向上键 ↑,up
回车键 ↵,enter
```

## 系统要求

- Python 3.6+
- Windows/macOS/Linux
- 管理员权限（某些系统可能需要）

## 故障排除

### 常见问题及解决方案

#### 1. ModuleNotFoundError: No module named 'pyautogui'
**问题**：缺少Python依赖包
**解决方案**：
```bash
# 方法1：使用自动依赖检查脚本
start_with_dependencies.bat

# 方法2：手动安装依赖
pip install pyautogui pynput Pillow
```

#### 2. Pillow安装失败
**问题**：Pillow版本兼容性问题
**解决方案**：
```bash
# 安装最新兼容版本
pip install Pillow

# 或者指定版本
pip install Pillow==11.3.0
```

#### 3. 其他检查项目
- 是否正确安装了所有依赖包
- 是否有足够的系统权限
- 防病毒软件是否阻止了程序运行
- 目标应用程序是否处于活动状态

## 许可证

此程序仅供学习和个人使用。请遵守相关法律法规，不要用于非法用途。 